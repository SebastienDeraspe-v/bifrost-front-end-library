import { Meta } from '@storybook/addon-docs/blocks';

<Meta
    title='Contribute'
    parameters={{ 
        layout: 'padded', 
        viewMode: 'docs',
        previewTabs: { canvas: { hidden: true } }
    }}
/>

# Contribute

Create or update an Angular or Twig element in the Design System.

<br/>

> Basically, there are 4 kinds of elements:
- **Components**
- **Templates** (to help build with components)
- **Pipes**
- **Styles** (e.g. Sass variables)

> We support 2 frameworks: **Angular** and **Drupal**.

<br/>

**Frequent questions:**

- [Zeroheight: How to know if the component should be on the Design System?]()
- [Other documentation]()

<br/>

## 1. Clone the repository

Clone [the Design System repository]() on your local machine and choose the version you want to work on: 

```
git clone <url>
git checkout v0.1.0
```

[Changelogs: List of all versions]()

## 2. Generate the component's structure
**Optional: Only if you want to create a new component.**

We created a command in order to help you start: 

`npm run generate component <component-name>`

<br/>

This command will:
- Copy `.templates/component-structure` folder and paste it in `/lib/components`.
- Then you will have starter files for Angular and Twig.
- Expose your new component in `public-api.ts`.

## 3. Develop it
Storybook provides an environment to develop in isolation. Let's open it:

`npm run storybook`

<br/>

Open **[http://localhost:9008]()** on your browser and find the page of your component on the sidebar.

**Et voila! Your environment is set up :)**

<br/>

<small>

**Note:** Since **Drupal** components are server side, you need to refresh the browser to see changes during development.

</small>

<br/>

**Ready to push? Make sure component is:**

- [x] Accessible (use [Axe]() inside Storybook panel or [Pa11y](https://github.com/pa11y/pa11y)) 
- [x] Agnostic / Universal
- [x] Content resilient
- [x] Responsive
- [x] Using design tokens from _variables.scss
- [x] API is consistent with other components
- [x] Unit test?

> **Component API:** As much as possible, try to use the **same component API** and the **same CSS** for Angular and Drupal.

> **Document Component States:** You could add stories to showcase the different states of your component. Just add them in `doc.stories.ts`.

## 4. _(Angular only)_ Export component
Export Module and/or Component files in `/lib/public-api.ts`.

## 5. Build library

Increment the version in `package.json` with the pattern: **MAJOR.MINOR.PATCH**. 
> If it's a major or minor change, Design System team should be warn.

Then build and publish:
```Shell
npm run build
npm publish
```
Your package version is now available for everyone.
You could check availability on the [NPM registry]() page.

## 6. Test Angular implementation
**Angular showcase Project** is aimed to showcase implementation.

Located here: `projects/angular-showcase`.

## 6. Test Drupal implementation
**Drupal showcase Project** is aimed to showcase implementation.

Located here: `projects/drupal-showcase`.

Process to recreate environemnt:
```Shell
# From https://www.drupal.org/docs/develop/local-server-setup/linux-development-environments/set-up-a-local-development-drupal-0-3

# Install Composer
php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
php -r "if (hash_file('sha384', 'composer-setup.php') === 'e5325b19b381bfd88ce90a5ddb7823406b2a38cff6bb704b0acc289a09c8128d4a8ce2bbafcd1fcbdc38666422fe2806') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;"
php composer-setup.php
# composer --version
# php -r "unlink('composer-setup.php');"

# Install Drupal
composer create-project drupal/recommended-project drupal-showcase
cd drupal-showcase
composer require --dev drupal/core-dev
composer global require hirak/prestissimo

```

<br/>

From the same repo, serve the project:

`ng serve angular-showcase`

Update the library:

`npm i bifrost-front-end-library@<your-new-version>`

Import the new component in App Module (`projects/angular-showcase/src/app/app.module.ts`).

Now, you will be able to add your component in a file (e.g. `app.component.html`).

## 7. Communicate
- Slack Channel?

<br/><br/>

### Reminder:
For each component's documentation, add:
- Link to jira request
- Link to Figma file
- Link to Zeroheight documentation

<br/>

### Need help?
Contact xxx@xxx.com