# Contribute
Create or update an Angular or Twig element in the Design System.

<br/>

We currently support 2 frameworks: **Angular and Twig**.

Basically, there are 5 kinds of elements:
- **Components** / **Organisms** (more complex components)
- **Templates** (to help build with components)
- **Pipes**
- **Styles** (e.g. Sass variables)
- **Assets** (e.g. Logo, images)
 
> All theses elements are build and publish as an **NPM package**.

<br/>

**Frequent questions:**

- [Zeroheight: How to know if the component should be on the Design System?]()
- [Other documentation...]()

<br/>

## 1. Clone the repository

Clone [the Design System repository]() on your local machine and choose the version you want to work on: 

```
git clone <url>
git checkout v0.1.0
```

[Changelogs: List of all versions]()

## 2. Generate the component's structure
**Optional: This step is useful only if you want to create a new component.**
<br/>

We created a command that will help you start a new component: 
Fust follow the instruction in your terminal. It will ask you the type of element you want to create (component, template, pipes, ...).

```bash
# From the root of the repo, enter:
npm run generate

# If you want to see your new component, launch Storybook:
npm run start-dev
```

<br/>

Under the hood, this command will:
- Copy `.templates/component-structure` folder and paste it in `/lib/components`.
- Then, you will be able to start working with the right structure.
- Finally, it will expose your new component in `public-api.ts`.


## 3. Develop it
Storybook provides an environment to develop in isolation. Let's open it:

```js
npm run start-dev
```

Open **[http://localhost:9008]()** on your browser and find the page of your component on the sidebar.
**Et voila! Your environment is set up :)**

<br/>

> Under the hood, `npm run start-dev` will:
> - Launch an express server to serve twig files.
> - Watch changes on twig files and auto-reload.
> - Prebuild Storybook.
> - Finally, launch Storybook at **http://localhost:9008** (Storybook will auto-reload on changes).

<br/>

<small>

**Note:** Since **Drupal** components are server side, you need to refresh the browser to see changes during development.

</small>

<br/>

**Ready to push? Make sure component is:**

- [x] Accessible (use [Axe]() inside Storybook panel or [Pa11y](https://github.com/pa11y/pa11y)) 
- [x] Agnostic / Universal
- [x] Content resilient
- [x] Responsive
- [x] Using design tokens from _variables.scss
- [x] API is consistent with other components
- [x] Unit test?

> **Component API:** As much as possible, try to use the **same component API** and the **same CSS** for Angular and Drupal.

> **Document Component States:** You could add stories to showcase the different states of your component. Just add them in `doc.stories.ts`.

## 4. _(Angular only)_ Export component
Export Module and/or Component files in `/lib/public-api.ts`.

## 5. Build library

Increment the version in `projects/front-end-library/package.json` with the pattern: **MAJOR.MINOR.PATCH**. 
> If it's a major or minor change, Design System team should be warn.

Then build and publish:
```bash
# This command will build and publish a new version of the front-end library.
npm run publish
```
Your new package version is now available for everyone.
You could check availability on the [NPM registry]() page.

## 6. Test Angular implementation
**Angular showcase Project** is aimed to showcase implementation.

Located here: `projects/angular-showcase`.

Serve the project:

`ng serve angular-showcase`

Update the library:

```bash
npm install bifrost-front-end-library@<your-new-version> --save
# or
npm install bifrost-front-end-library@latest --save
```

Import the new component in App Module (`projects/angular-showcase/src/app/app.module.ts`).

Now, you will be able to add your component in a file (e.g. `app.component.html`).

More details in the **Angular implementation page**.


## 6. Test Drupal implementation
**Drupal showcase Project** is aimed to showcase implementation.

- Install Drupal in **/drupal-showcase** folder. Mac or Window install...
- Open Drupal Admin Page and check that **bifrost** theme is active.
- TODO: Install with local npm package / npm in registry.
- TODO: Check visual regression with BackStopJS.

```bash
```

<br/>

## 7. Communicate
- Slack Channel?

<br/><br/>

### Browser compatibility
Launch `npx browserslist` to know our current support of browser.

<br/>

### Need help?
Contact xxx@xxx.com